/*!
 * jQuery Nested Nav
 * Original author: @amurrell
 * Licensed under the MIT license
 */
!function(e){var t=function(){return Math.floor(1e5*Math.random())},n=e(window).width();e.fn.nestednav=function(a){function s(e,t){setTimeout(function(){if(e.window.width()>w.menuCollapseWidth)e.wrapper.css("height","auto").hide();else{e.wrapper.css("height","auto");var t=e.document.height()-r(e);e.wrapper.css("height",t+"px")}},t)}function r(t){var n=""===w.offsetMenuTargetSelector?t.nav:e(w.offsetMenuTargetSelector),a=n.offset(),s=a.top+n.outerHeight();return t.wrapper.offset({top:s}),s}function o(e){var t=[];return t.text=e.text(),t.hrefText=e.attr("href"),t.href=void 0===t.hrefText||"javascript:void(0);"===t.hrefText?"":t.hrefText,t.html=t.href.length?'<a class="'+w.nestedItemLinkClass+'"href="'+t.href+'">'+t.text+"</a>":'<div class="'+w.nestedItemNoLinkClass+'">'+t.text+"</div>",t}function d(e,t,n){var a=[];return a["class"]=w.nestedItemClass+" "+(t.href.length?w.nestedItemLinkClass:""),a.isDropdown=e.hasClass(w.dropdownClass)||e.hasClass(w.dropdownSubMenuClass),a.dataDropdown=a.isDropdown?'data-dropdown="'+n+'"':"",a.caretHtml=a.isDropdown?'<div class="'+w.caretClass+'" '+a.dataDropdown+">"+w.caretIconHtml+"</div>":'<div class="'+w.noCaretClass+'"></div>',a.html='<div class="'+a["class"]+'">'+a.caretHtml+t.html+"</div>",a}function i(n,a){var s="";n.each(function(){var n=e(this),a=n.children("a"),r=n.children(w.dropdownSelector),i="drop-"+t(),l=o(a),c=d(n,l,i);a.attr("data-label",i),r.attr("data-dropdown",i),s+=c.html});var r=e(s);return w.linklessTriggers&&r.find("."+w.nestedItemNoLinkClass).each(function(){var t=e(this),n=t.closest("."+w.nestedItemClass).find("[data-dropdown]");n.length&&t.attr("data-dropdown",n.attr("data-dropdown"))}),p(r.find("[data-dropdown]"),"nested-caret",a),r}function l(t,n){var a=t.attr("data-dropdown"),s=n.mainNav.find("[data-label="+a+"]").text(),r=n.mainNav.find("[data-dropdown="+a+"]").children(w.subNavChildrenSelector),o=i(r,n),d=[];d.close='<div class="'+w.nestedBoxCloseClass+'">'+w.nestedBoxIconHtml+"</div>",d.title='<div class="'+w.nestedBoxTitleClass+'">'+s+d.close+"</div>",d.content='<div class="'+w.nestedBoxClass+'"></div>',d.containerStart='<div class="'+w.nestedDropdownContainerClass+" "+w.transClass+'">',d.containerMid=d.title+d.content,d.containerEnd="</div>";var l=d.containerStart+d.containerMid+d.containerEnd,c=e(l);return c.find("."+w.nestedBoxClass).html(o),p(c.find("."+w.nestedBoxCloseClass),"close-nested-box",n),c}function c(e){var t=e.mainNav.children(w.mainNavChildrenSelector);e.wrapper.append(i(t,e)),e.nav.prepend(e.wrapper),r(e),s(e,w.setHeightInitialDelay)}function p(t,a,o){switch(a){case"nested-caret":t.click(function(){var t=e("#"+w.backdropID),n=l(e(this),o);o.wrapper.find("."+w.nestedDropdownContainerClass).addClass(w.nestedSendBackClass),t.length||o.wrapper.append(o.backdropHtml),o.wrapper.append(n),e("html, body").animate({scrollTop:0},300),setTimeout(function(){n.addClass(w.showDropdownClass),s(o,w.setHeightDropdownDelay)},w.showDropdownDelay)});break;case"window-resize":t.resize(function(){var t=e(this).width();n!==t&&(t<w.menuCollapseWidth?(s(o,w.setHeightInitialDelay),o.wrapper.removeClass(w.nestedDrawerShowClass).show()):o.wrapper.removeClass(w.nestedDrawerShowClass).hide(),o.wrapper.find("#"+w.backdropID).add("."+w.nestedDropdownContainerClass).remove(),n=t,r(o))});break;case"menu-btn":t.click(function(t){if(!(o.window.width()>w.menuCollapseWidth)){t.preventDefault(),t.stopPropagation();var n=e("#"+w.wrapperID);return n.length&&n.hasClass(w.nestedDrawerShowClass)?(n.removeClass(w.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","auto"),s(o,0)},w.nestedDrawerTransDelay)):n.length?(n.addClass(w.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","hidden")},w.nestedDrawerTransDelay)):void 0}});break;case"close-nested-box":t.click(function(){var t=e(this),n=t.closest("."+w.nestedDropdownContainerClass),a=o.wrapper.find("#"+w.backdropID);n.removeClass(w.showDropdownClass),setTimeout(function(){n.remove();var t=e("."+w.nestedDropdownContainerClass).last();t.removeClass(w.nestedSendBackClass),s(o,0),e("."+w.nestedDropdownContainerClass).length||a.remove()},w.hideDropdownDelay)})}}var w=e.extend({},e.fn.nestednav.defaults,a);return this.each(function(){var t=e(this),n={nav:t,computedHeight:0,menuButton:e(w.menuButtonSelector),mainNav:e(w.mainNavSelector),wrapper:e("<div />").attr(w.wrapperAttr).addClass(w.transClass).attr("id",w.wrapperID),window:e(window),document:e(document),backdropHtml:e("<div></div>").attr(w.backdropAttr).attr("id",w.backdropID)};c(n),p(n.window,"window-resize",n),p(n.menuButton,"menu-btn",n)})},e.fn.nestednav.defaults={setHeightInitialDelay:300,setHeightDropdownDelay:550,hideDropdownDelay:550,showDropdownDelay:330,nestedDrawerTransDelay:550,menuButtonSelector:".btn.btn-navbar",mainNavSelector:".navbar-inner ul.nav",dropdownSelector:"ul",mainNavChildrenSelector:"li",subNavChildrenSelector:"li",offsetMenuTargetSelector:"",dropdownClass:"dropdown",dropdownSubMenuClass:"dropdown-submenu",nestedItemClass:"nested-item",nestedItemLinkClass:"nested-link",nestedItemNoLinkClass:"nested-no-link",showDropdownClass:"nested-dropdown-show",nestedDrawerShowClass:"nested-drawer-show",nestedDropdownContainerClass:"nested-container",nestedSendBackClass:"nested-back",noCaretClass:"nested-no-caret",caretClass:"nested-caret",nestedBoxTitleClass:"nested-box-title",nestedBoxCloseClass:"nested-box-close",nestedBoxClass:"nested-box",transClass:"nested-trans",caretIconHtml:'<i class="icon-caret-down"></i>',nestedBoxIconHtml:'<i class="icon-remove"></i>',wrapperID:"nested-nav",backdropID:"nested-backdrop",wrapperAttr:{"class":"nested-nav nested-hide"},backdropAttr:{"class":"modal-backdrop fade in"},menuCollapseWidth:1e3,linklessTriggers:!0}}(jQuery);