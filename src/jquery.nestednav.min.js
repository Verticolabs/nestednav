/*!
 * jQuery Nested Nav
 * Original author: @amurrell
 * Licensed under the MIT license
 */
!function(e){var t=function(){return Math.floor(1e5*Math.random())},a=e(window).width();e.fn.nestednav=function(n){function s(e,t){setTimeout(function(){if(e.window.width()>w.menuCollapseWidth)e.wrapper.css("height","auto").hide();else{e.wrapper.css("height","auto");var t=e.document.height()-r(e);e.wrapper.css("height",t+"px")}},t)}function r(t){var a=""===w.offsetMenuTargetSelector?t.nav:e(w.offsetMenuTargetSelector),n=a.offset(),s=n.top+a.outerHeight();return t.wrapper.offset({top:s}),s}function o(e){var t=[];return t.text=e.text(),t.hrefText=e.attr("href"),t.href=void 0===t.hrefText||"javascript:void(0);"===t.hrefText?"":t.hrefText,t.html=t.href.length?'<a class="'+w.nestedItemLinkClass+'"href="'+t.href+'">'+t.text+"</a>":'<div class="'+w.nestedItemNoLinkClass+'">'+t.text+"</div>",t}function d(e,t,a){var n=[];return n["class"]=w.nestedItemClass+" "+(t.href.length?w.nestedItemLinkClass:""),n.isDropdown=e.hasClass(w.dropdownClass)||e.hasClass(w.dropdownSubMenuClass),n.dataDropdown=n.isDropdown?'data-dropdown="'+a+'"':"",n.caretHtml=n.isDropdown?'<div class="'+w.caretClass+'" '+n.dataDropdown+">"+w.caretIconHtml+"</div>":'<div class="'+w.noCaretClass+'"></div>',n.html='<div class="'+n["class"]+'">'+n.caretHtml+t.html+"</div>",n}function i(a,n){var s="";a.each(function(){var a=e(this),r=a.children("a"),i=a.children(w.dropdownSelector),l="drop-"+t(),c=o(r),p=d(a,c,l);r.attr("data-label",l),i.attr("data-dropdown",l),s+=p.html,w.realMenuTriggers&&a.parent().is(n.mainNav)&&i.length&&a.attr("data-dropdown",l)});var r=e(s);return w.linklessTriggers&&r.find("."+w.nestedItemNoLinkClass).each(function(){var t=e(this),a=t.closest("."+w.nestedItemClass).find("[data-dropdown]");a.length&&t.attr("data-dropdown",a.attr("data-dropdown"))}),p(r.find("[data-dropdown]"),"nested-caret",n),w.realMenuTriggers&&p(n.mainNav.children().filter("[data-dropdown]"),"nested-caret",n),r}function l(t,a){var n=t.attr("data-dropdown"),s=a.mainNav.find("[data-label="+n+"]").text(),r=a.mainNav.find("[data-label="+n+"]").attr("href"),o=void 0===r||"javascript:void(0);"===r?s:'<a href="'+r+'">'+s+"</a>",d=a.mainNav.find("[data-dropdown="+n+"]").children(w.subNavChildrenSelector),l=i(d,a),c=[];c.close='<div class="'+w.nestedBoxCloseClass+'">'+w.nestedBoxIconHtml+"</div>",c.title='<div class="'+w.nestedBoxTitleClass+'">'+o+c.close+"</div>",c.content='<div class="'+w.nestedBoxClass+'"></div>',c.containerStart='<div class="'+w.nestedDropdownContainerClass+" "+w.transClass+'">',c.containerMid=c.title+c.content,c.containerEnd="</div>";var h=c.containerStart+c.containerMid+c.containerEnd,v=e(h);return v.find("."+w.nestedBoxClass).html(l),p(v.find("."+w.nestedBoxCloseClass),"close-nested-box",a),v}function c(e){var t=e.mainNav.children(w.mainNavChildrenSelector);e.wrapper.append(i(t,e)),e.nav.prepend(e.wrapper),r(e),s(e,w.setHeightInitialDelay)}function p(t,n,o){switch(n){case"nested-caret":t.click(function(t){var a=e(this);if(a.parent().is(o.mainNav)){if(o.window.width()>w.realMenuTriggerWidth)return;t.preventDefault(),t.stopImmediatePropagation()}var n=e("#"+w.backdropID),r=l(a,o);o.wrapper.find("."+w.nestedDropdownContainerClass).addClass(w.nestedSendBackClass),n.length||o.wrapper.append(o.backdropHtml),o.wrapper.append(r),e("html, body").animate({scrollTop:0},300),setTimeout(function(){r.addClass(w.showDropdownClass),s(o,w.setHeightDropdownDelay)},w.showDropdownDelay)});break;case"window-resize":t.resize(function(){var t=e(this).width();a!==t&&(t<w.menuCollapseWidth?(s(o,w.setHeightInitialDelay),o.wrapper.removeClass(w.nestedDrawerShowClass).show()):o.wrapper.removeClass(w.nestedDrawerShowClass).hide(),o.wrapper.find("#"+w.backdropID).add("."+w.nestedDropdownContainerClass).remove(),a=t,r(o))});break;case"menu-btn":t.click(function(t){if(!(o.window.width()>w.menuCollapseWidth)){t.preventDefault(),t.stopPropagation();var a=e("#"+w.wrapperID);return a.length&&a.hasClass(w.nestedDrawerShowClass)?(a.removeClass(w.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","auto"),s(o,0)},w.nestedDrawerTransDelay)):a.length?(a.addClass(w.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","hidden")},w.nestedDrawerTransDelay)):void 0}});break;case"close-nested-box":t.click(function(){var t=e(this),a=t.closest("."+w.nestedDropdownContainerClass),n=o.wrapper.find("#"+w.backdropID);a.removeClass(w.showDropdownClass),setTimeout(function(){a.remove();var t=e("."+w.nestedDropdownContainerClass).last();t.removeClass(w.nestedSendBackClass),s(o,0),e("."+w.nestedDropdownContainerClass).length||n.remove()},w.hideDropdownDelay)})}}var w=e.extend({},e.fn.nestednav.defaults,n);return this.each(function(){var t=e(this),a={nav:t,computedHeight:0,menuButton:e(w.menuButtonSelector),mainNav:e(w.mainNavSelector),wrapper:e("<div />").attr(w.wrapperAttr).addClass(w.transClass).attr("id",w.wrapperID),window:e(window),document:e(document),backdropHtml:e("<div></div>").attr(w.backdropAttr).attr("id",w.backdropID)};c(a),p(a.window,"window-resize",a),p(a.menuButton,"menu-btn",a)})},e.fn.nestednav.defaults={setHeightInitialDelay:300,setHeightDropdownDelay:550,hideDropdownDelay:550,showDropdownDelay:330,nestedDrawerTransDelay:550,menuButtonSelector:".btn.btn-navbar",mainNavSelector:".navbar-inner ul.nav",dropdownSelector:"ul",mainNavChildrenSelector:"li",subNavChildrenSelector:"li",offsetMenuTargetSelector:"",dropdownClass:"dropdown",dropdownSubMenuClass:"dropdown-submenu",nestedItemClass:"nested-item",nestedItemLinkClass:"nested-link",nestedItemNoLinkClass:"nested-no-link",showDropdownClass:"nested-dropdown-show",nestedDrawerShowClass:"nested-drawer-show",nestedDropdownContainerClass:"nested-container",nestedSendBackClass:"nested-back",noCaretClass:"nested-no-caret",caretClass:"nested-caret",nestedBoxTitleClass:"nested-box-title",nestedBoxCloseClass:"nested-box-close",nestedBoxClass:"nested-box",transClass:"nested-trans",caretIconHtml:'<i class="icon-caret-down"></i>',nestedBoxIconHtml:'<i class="icon-remove"></i>',wrapperID:"nested-nav",backdropID:"nested-backdrop",wrapperAttr:{"class":"nested-nav nested-hide"},backdropAttr:{"class":"modal-backdrop fade in"},menuCollapseWidth:1e3,linklessTriggers:!0,realMenuTriggers:0,realMenuTriggerWidth:1e3}}(jQuery);