/*!
 * jQuery Nested Nav
 * Original author: @amurrell
 * Licensed under the MIT license
 */
!function(e){var t=function(){return Math.floor(1e5*Math.random())},n=e(window).width();e.fn.nestednav=function(a){function s(e,t){setTimeout(function(){if(e.computedHeight=e.wrapper.outerHeight(),e.window.width()>p.menuCollapseWidth)e.wrapper.css("height","auto").hide();else{e.wrapper.css("height","auto");var t=e.document.height()-40,n=e.computedHeight>t?e.computedHeight:t;e.wrapper.css("height",n+"px")}},t)}function r(e){var t=[];return t.text=e.text(),t.hrefText=e.attr("href"),t.href=void 0===t.hrefText||"javascript:void(0);"===t.hrefText?"":t.hrefText,t.html=t.href.length?'<a class="'+p.nestedItemLinkClass+'"href="'+t.href+'">'+t.text+"</a>":t.text,t}function o(e,t,n){var a=[];return a["class"]=p.nestedItemClass+" "+(t.href.length?p.nestedItemLinkClass:""),a.isDropdown=e.hasClass(p.dropdownClass)||e.hasClass(p.dropdownSubMenuClass),a.dataDropdown=a.isDropdown?'data-dropdown="'+n+'"':"",a.caretHtml=a.isDropdown?'<div class="'+p.caretClass+'" '+a.dataDropdown+">"+p.caretIconHtml+"</div>":'<div class="'+p.noCaretClass+'"></div>',a.html='<div class="'+a["class"]+'">'+a.caretHtml+t.html+"</div>",a}function d(n,a){var s="";n.each(function(){var n=e(this),a=n.children("a"),d=n.children(p.dropdownSelector),i="drop-"+t(),l=r(a),c=o(n,l,i);a.attr("data-label",i),d.attr("data-dropdown",i),s+=c.html});var d=e(s);return c(d.find("."+p.caretClass),"nested-caret",a),d}function i(t,n){var a=t.attr("data-dropdown"),s=n.mainNav.find("[data-label="+a+"]").text(),r=n.mainNav.find("[data-dropdown="+a+"]").children(p.subNavChildrenSelector),o=d(r,n),i=[];i.close='<div class="'+p.nestedBoxCloseClass+'">'+p.nestedBoxIconHtml+"</div>",i.title='<div class="'+p.nestedBoxTitleClass+'">'+s+i.close+"</div>",i.content='<div class="'+p.nestedBoxClass+'"></div>',i.containerStart='<div class="'+p.nestedDropdownContainerClass+" "+p.transClass+'">',i.containerMid=i.title+i.content,i.containerEnd="</div>";var l=i.containerStart+i.containerMid+i.containerEnd,w=e(l);return w.find("."+p.nestedBoxClass).html(o),c(w.find("."+p.nestedBoxCloseClass),"close-nested-box",n),w}function l(e){var t=e.mainNav.children(p.mainNavChildrenSelector);e.wrapper.append(d(t,e)),e.nav.prepend(e.wrapper),s(e,p.setHeightInitialDelay)}function c(t,a,r){switch(a){case"nested-caret":t.click(function(){var t=e("#"+p.backdropID),n=i(e(this),r);r.wrapper.find("."+p.nestedDropdownContainerClass).addClass(p.nestedSendBackClass),t.length||r.wrapper.append(r.backdropHtml),r.wrapper.append(n),e("html, body").animate({scrollTop:0},300),setTimeout(function(){n.addClass(p.showDropdownClass),s(r,p.setHeightDropdownDelay)},p.showDropdownDelay)});break;case"window-resize":t.resize(function(){var t=e(this).width();n!==t&&(t<p.menuCollapseWidth?(r.wrapper.css("height",r.document.height()+"px"),r.wrapper.removeClass(p.nestedDrawerShowClass).show()):(r.wrapper.find("#"+p.backdropID).add(p.nestedDropdownContainerClass).remove(),r.wrapper.removeClass(p.nestedDrawerShowClass).hide()),n=t)});break;case"menu-btn":t.click(function(t){if(!(r.window.width()>p.menuCollapseWidth)){t.preventDefault(),t.stopPropagation();var n=e("#"+p.wrapperID);return n.length&&n.hasClass(p.nestedDrawerShowClass)?(n.removeClass(p.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","auto"),s(r,0)},p.nestedDrawerTransDelay)):n.length?(n.addClass(p.nestedDrawerShowClass),void setTimeout(function(){e("body").css("overflow-x","hidden")},p.nestedDrawerTransDelay)):void 0}});break;case"close-nested-box":t.click(function(){var t=e(this),n=t.closest("."+p.nestedDropdownContainerClass),a=r.wrapper.find("#"+p.backdropID);n.removeClass(p.showDropdownClass),setTimeout(function(){n.remove();var t=e("."+p.nestedDropdownContainerClass).last();t.removeClass(p.nestedSendBackClass),s(r,0),e("."+p.nestedDropdownContainerClass).length||a.remove()},p.hideDropdownDelay)})}}var p=e.extend({},e.fn.nestednav.defaults,a);return this.each(function(){var t=e(this),n={nav:t,computedHeight:0,menuButton:e(p.menuButtonSelector),mainNav:e(p.mainNavSelector),wrapper:e("<div />").attr(p.wrapperAttr).addClass(p.transClass).attr("id",p.wrapperID),window:e(window),document:e(document),backdropHtml:e("<div></div>").attr(p.backdropAttr).attr("id",p.backdropID)};l(n),c(n.window,"window-resize",n),c(n.menuButton,"menu-btn",n)})},e.fn.nestednav.defaults={menuCollapseWidth:1e3,offsetMenu:40,setHeightInitialDelay:300,setHeightDropdownDelay:550,hideDropdownDelay:550,showDropdownDelay:330,nestedDrawerTransDelay:550,menuButtonSelector:".btn.btn-navbar",mainNavSelector:".navbar-inner ul.nav",dropdownSelector:"ul",mainNavChildrenSelector:"li",subNavChildrenSelector:"li",dropdownClass:"dropdown",dropdownSubMenuClass:"dropdown-submenu",nestedItemClass:"nested-item",nestedItemLinkClass:"nested-link",showDropdownClass:"nested-dropdown-show",nestedDrawerShowClass:"nested-drawer-show",nestedDropdownContainerClass:"nested-container",nestedSendBackClass:"nested-back",noCaretClass:"nested-no-caret",caretClass:"nested-caret",nestedBoxTitleClass:"nested-box-title",nestedBoxCloseClass:"nested-box-close",nestedBoxClass:"nested-box",transClass:"nested-trans",caretIconHtml:'<i class="icon-caret-down"></i>',nestedBoxIconHtml:'<i class="icon-remove"></i>',wrapperID:"nested-nav",backdropID:"nested-backdrop",wrapperAttr:{"class":"nested-nav hide"},backdropAttr:{"class":"modal-backdrop fade in"}}}(jQuery);